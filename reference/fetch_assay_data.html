<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fetch assay data from single assay of choice — fetch_assay_data • FacileData</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Fetch assay data from single assay of choice — fetch_assay_data" />
<meta property="og:description" content="The (fetch|with)_assay_data functions are some of the main workhose
functions of the facile ecosystem. These calls enable you to retrieve
raw and noramlized assay data from a FacileData container." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FacileData</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.12.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/FacileData.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/FacileDataSet-architecture.html">FacileDataSet Architecture</a>
    </li>
    <li>
      <a href="../articles/FacileDataSet-assembly.html">FacileDataSet Assembly</a>
    </li>
    <li>
      <a href="../articles/FacileDataSet.html">FacileDataSet Overview</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/facilebio/FacileData/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fetch assay data from single assay of choice</h1>
    <small class="dont-index">Source: <a href='https://github.com/facilebio/FacileData/blob/master/R/api.R'><code>R/api.R</code></a>, <a href='https://github.com/facilebio/FacileData/blob/master/R/assay-data.R'><code>R/assay-data.R</code></a></small>
    <div class="hidden name"><code>fetch_assay_data.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The <code>(fetch|with)_assay_data</code> functions are some of the main workhose
functions of the facile ecosystem. These calls enable you to retrieve
raw and noramlized assay data from a FacileData container.</p>
    </div>

    <pre class="usage"><span class='fu'>fetch_assay_data</span><span class='op'>(</span>
  <span class='va'>x</span>,
  <span class='va'>features</span>,
  samples <span class='op'>=</span> <span class='cn'>NULL</span>,
  assay_name <span class='op'>=</span> <span class='fu'>ndefault_assay</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>,
  normalized <span class='op'>=</span> <span class='cn'>FALSE</span>,
  batch <span class='op'>=</span> <span class='cn'>NULL</span>,
  main <span class='op'>=</span> <span class='cn'>NULL</span>,
  as.matrix <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>...</span>,
  subset.threshold <span class='op'>=</span> <span class='fl'>700</span>,
  aggregate <span class='op'>=</span> <span class='cn'>FALSE</span>,
  aggregate.by <span class='op'>=</span> <span class='st'>"ewm"</span>,
  verbose <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span>

<span class='co'># S3 method for facile_frame</span>
<span class='fu'>with_assay_data</span><span class='op'>(</span>
  <span class='va'>x</span>,
  <span class='va'>features</span>,
  assay_name <span class='op'>=</span> <span class='cn'>NULL</span>,
  normalized <span class='op'>=</span> <span class='cn'>TRUE</span>,
  aggregate <span class='op'>=</span> <span class='cn'>FALSE</span>,
  aggregate.by <span class='op'>=</span> <span class='st'>"ewm"</span>,
  spread <span class='op'>=</span> <span class='cn'>TRUE</span>,
  with_assay_name <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>...</span>,
  verbose <span class='op'>=</span> <span class='cn'>FALSE</span>,
  .fds <span class='op'>=</span> <span class='fu'><a href='fds.html'>fds</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A <code>FacileDataSrote</code> object, or <code>facile_frame</code></p></td>
    </tr>
    <tr>
      <th>features</th>
      <td><p>a feature descriptor (data.frame with assay and feature_id
columms)</p></td>
    </tr>
    <tr>
      <th>samples</th>
      <td><p>a samples descriptor</p></td>
    </tr>
    <tr>
      <th>assay_name</th>
      <td><p>the name of the assay to fetch data from. Defaults to the
value of <code>default_assay()</code> for <code>x</code>. Must be a subset of <code>assay_names(x)</code>.</p></td>
    </tr>
    <tr>
      <th>normalized</th>
      <td><p>return normalize or raw data values, defaults to <code>FALSE</code>.
This is only really "functional" for for <code>assay_type = "rnaseq"</code> types
of assays, where the normalized data is log2(CPM). These values can
be tweaked with <code>log = (TRUE|FALSE)</code> and <code>prior.count</code> parameters, which
can passed down internally to (eventually) <code><a href='https://rdrr.io/pkg/edgeR/man/cpm.html'>edgeR::cpm()</a></code>.</p></td>
    </tr>
    <tr>
      <th>batch</th>
      <td><p>The column names in <code>sample_info</code> that specify the batch
covariates in the data that will be regressed out.</p></td>
    </tr>
    <tr>
      <th>main</th>
      <td><p>The name of a covaraite in <code>sample_info</code> that contains a known
covariate that describes the "effect" of an experiment that should not
be regressed out. Please refer to the Details section for more informaiton.</p></td>
    </tr>
    <tr>
      <th>as.matrix</th>
      <td><p>by default, the data is returned in a long-form tbl-like
result. If set to <code>TRUE</code>, the data is returned as a matrix.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>parameters to pass to normalization methods</p></td>
    </tr>
    <tr>
      <th>subset.threshold</th>
      <td><p>sometimes fetching all the genes is faster than
trying to subset. We have to figure out why that is, but I've previously
tested random features of different lengths, and around 700 features was
the elbow.</p></td>
    </tr>
    <tr>
      <th>aggregate.by</th>
      <td><p>do you want individual level results or geneset
scores? Use 'ewm' for eigenWeightedMean, and that's all.</p></td>
    </tr>
    <tr>
      <th>.fds</th>
      <td><p>A <code>FacileDataSet</code> object</p></td>
    </tr>
    <tr>
      <th>feature_ids</th>
      <td><p>character vector of feature_ids</p></td>
    </tr>
    <tr>
      <th>with_symbols</th>
      <td><p>Do you want gene symbols returned, too?</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code>tibble</code> (lazy or not) with assay data.</p>
<p>a tbl-like result</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>fetch_assay_data(x, ...)</code> will return the data in long form.
<code>with_assay_data(x, ...)</code> is most typically used when you already have
a dataset <code>x</code> (a <code>facile_frame</code>) that you want to decorate with more assay
data. The assay data asked for will be appended on to <code>x</code> in wide format.
Because <code>fetch</code> is (most often) used at a lower level of granularity,
<code>normalize</code> is by default set to <code>FALSE</code>, while it is set to <code>TRUE</code> in
<code>with_assay_data</code>.</p>
    <h2 class="hasAnchor" id="removing-batch-effects"><a class="anchor" href="#removing-batch-effects"></a>Removing Batch Effects</h2>

    

<p>When normalized data is returned, we assume these data are log-like, and you
have the option to regress out batch effects using our
<code><a href='remove_batch_effect.html'>remove_batch_effect()</a></code> wrapper to <code><a href='https://rdrr.io/pkg/limma/man/removeBatchEffect.html'>limma::removeBatchEffect()</a></code>.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>samples</span> <span class='op'>&lt;-</span> <span class='fu'><a href='exampleFacileDataSet.html'>exampleFacileDataSet</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>filter_samples</span><span class='op'>(</span><span class='va'>indication</span> <span class='op'>==</span> <span class='st'>"BLCA"</span>, <span class='va'>sample_type</span> <span class='op'>==</span> <span class='st'>"tumor"</span><span class='op'>)</span>
<span class='va'>features</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>PRF1<span class='op'>=</span><span class='st'>'5551'</span>, GZMA<span class='op'>=</span><span class='st'>'3001'</span>, CD274<span class='op'>=</span><span class='st'>'29126'</span><span class='op'>)</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'>with_assay_data</span><span class='op'>(</span><span class='va'>samples</span>, <span class='va'>features</span>, normalized <span class='op'>=</span> <span class='cn'>TRUE</span>, batch <span class='op'>=</span> <span class='st'>"sex"</span><span class='op'>)</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'>with_assay_data</span><span class='op'>(</span><span class='va'>samples</span>, <span class='va'>features</span>, normalized <span class='op'>=</span> <span class='cn'>TRUE</span>,
                       batch <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"sex"</span>, <span class='st'>"stage"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'>with_assay_data</span><span class='op'>(</span><span class='va'>samples</span>, <span class='va'>features</span>, normealized <span class='op'>=</span> <span class='cn'>TRUE</span>,
                       batch <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"sex"</span>, <span class='st'>"stage"</span><span class='op'>)</span>, main <span class='op'>=</span> <span class='st'>"sample_type"</span><span class='op'>)</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Steve Lianoglou, Vincent Rouilly, Peter Haverty, Denali Therapeutics, Genentech.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


